## 重入攻击（Re-Entrancy Attack）
### **对应官方地址**
**url** [https://solidity-by-example.org/hacks/re-entrancy/]

### **问题**
攻击者在外部调用中反复"重新进入"合约，利用状态未及时更新的漏洞重复执行敏感逻辑，比如多次提取资金

### **例子**
有些合约在转账之后才更新用户余额，那就会被攻击者利用，在 fallback 或 receive 函数里递归调用那个提款函数，疯狂提钱，直到合约被榨干。

### **防范措施**
1. 使用Checks-Effects-Interactions模式（先检查条件，修改状态，最后进行外部调用）
2. 采用reentrancyGuard（如OpenZeppelin的ReentrancyGuard）
3. 尽量使用transfer或call发送ETH，并确保调用方不会影响合约逻辑
</br></br></br></br>


## 整数溢出攻击（Arithmetic Overflow and Underflow）
### **对应官方地址**
**url** [https://solidity-by-example.org/hacks/overflow/]

### **问题**
攻击者利用整数运算的溢出特性，绕过系统的限制或逻辑判断，达到恶意目的

### **例子**
1. 绕过限制检查
   1. 金额字段绕过余额不足检查
   2. 如if（balance >= amount）,但amount 是溢出后的负数
2. 资源分配攻击：计算数组大小、内存分配时发生溢出，导致程序分配比期望小很多的内存
3. 在区块链合约中利用溢出篡改状态变量：例如在ERC20中增加或减少代币余额，绕过检查直接溢出为最大值或负值

### **防范措施**
1. 使用安全库：在Openzeppelin中的SafeMath
2. 类型范围控制：不要轻易使用uint8、int8等小位数整数
3. 检查输入和边界：对用户输入进行合理性判断
4. Solidity 0.8：0.8之后自动修补了该漏洞

</br></br></br></br>

## 自毁攻击（Self Destruct Attacks）
### **对应官方地址**
**url** [https://solidity-by-example.org/hacks/self-destruct/]

### **问题**
攻击者利用合约中的selfdestruct（Solidity旧版本）或者 SELFDESTRUCT（Solidity新版本）操作码，销毁合约并将剩余ETH强制发送到指定地址的行为

### **攻击核心**
1. selfdestruct操作
   1. Solidity中selfdestruct（address）可以销毁当前合约，并将合约余额强制发送到指定地址
   2. 被销毁的合约代码会从链上移除（节点数据中还能查询历史），这个地址变成空壳
2. 强制发送ETH：攻击者可以部署一个合约并向其转入一些ETH，然后调用selfdestruct(victimAddress),将ETH强制发送到victimAddress,无视其是否有receive（）或fallback（）函数

### **例子**
1. 破坏ETH余额判断逻辑
```Solidity
// 攻击者通过自毁合约强制发送1ETH给Victim，使其isRich（）返回true，可能绕过某些权限判断，奖池资格判断等
contract Victim {
   function isRich() public view returns (bool){
      return address(this).balance >= 1 ether;
   }
}
```

2. 导致合约失效或被永久锁定  
某些UUPS代理或EIP-1167 minimal Proxy结构中，如果攻击者设法让实现合约被销毁（例如某个授权失误的selfdestruct），那么代理将指向一个空地址，从而合约逻辑完全失效，导致所有调用revert、升级不可用、资金锁死等

### **防范措施**
1. 避免在合约中引入selfdestruct逻辑
2. 不依赖address(this).balance来判断关键业务逻辑
3. 使用extcodesize(address)检查地址是否有合约代码，防止目标合约已被销毁
```Solidity
   function isContract(addrss addr) internal view returns(bool) {
      uint32 size;
      assembly {
         size := extcodesize(addr)
      }
      return (size > 0)
   }
```
4. 对于代理合约，实现合约应做好访问控制，防止任何人调用selfdestruct

### **简叙**  
自毁攻击是指攻击者通过selfdestract将合约销毁并强制发送ETH到其他合约地址，可能绕过合约的接收控制或余额判断逻辑。危害包括绕过权限验证，污染合约余额，甚至破坏代理合约结构。防御方法包括避免依赖余额判断、检查合约代码存在性、以及限制selfdestruct的使用权限